<Page x:Class="Medvedeva_PrivateAdertisementService.AdsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Medvedeva_PrivateAdertisementService"
      mc:Ignorable="d" 
      d:DesignHeight="450" d:DesignWidth="800"
       Title="Все объявления">

    <Grid Margin="20">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0">

            <DockPanel Margin="0 0 0 16">

                <TextBlock Text="Все объявления"
                           Style="{StaticResource PageTitle}"
                           DockPanel.Dock="Left"/>

                <Button Content="Добавить объявление"
                        Style="{StaticResource SuccessButton}"
                        Height="38"
                        HorizontalAlignment="Right"
                        Click="AddAd_Click"
                        DockPanel.Dock="Right"/>
            </DockPanel>

            <TextBox x:Name="SearchBox"
                     Height="30"
                     ToolTip="Поиск по названию или описанию..."
                     Margin="0 0 0 16"
                     TextChanged="FilterChanged"/>

            <StackPanel Orientation="Horizontal" Margin="0 0 0 16">

                <ComboBox x:Name="CityFilter"
                          SelectionChanged="FilterChanged"
                          ToolTip="Город"/>

                <ComboBox x:Name="CategoryFilter"
                          SelectionChanged="FilterChanged"
                          ToolTip="Категория"/>

                <ComboBox x:Name="TypeFilter"
                          SelectionChanged="FilterChanged"
                          ToolTip="Тип"/>

                <Button Content="Сбросить"
                        Width="120"
                        Height="30"
                        Click="ResetFilters_Click"/>
            </StackPanel>

        </StackPanel>

        <ScrollViewer Grid.Row="1">
            <ItemsControl x:Name="AdsList">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>

                        <Border Style="{StaticResource AdCard}">

                            <Grid Margin="10">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="120"/>
                                </Grid.ColumnDefinitions>

                                <Image Source="{Binding ImagePath}"
                                       Width="140"
                                       Height="140"
                                       Stretch="UniformToFill"/>

                                <StackPanel Grid.Column="1" Margin="16 0 0 0">

                                    <TextBlock Text="{Binding Title}"
                                               Style= "{StaticResource SubTitle}"/>

                                    <TextBlock Text="{Binding Description}"
                                               Margin="0 6 0 6"
                                               Foreground="{StaticResource SecondaryText}"/>

                                    <TextBlock Text="{Binding Price, StringFormat='Цена: {0} ₽'}"
                                               FontWeight="Bold"
                                               Foreground="{StaticResource PrimaryText}"/>

                                    <TextBlock Text="{Binding CityName}"
                                               Foreground="{StaticResource SecondaryText}"/>
                                    <TextBlock Text="{Binding CategoryName}"
                                               Foreground="{StaticResource SecondaryText}"/>
                                    <TextBlock Text="{Binding AdTypeName}"
                                               Foreground="{StaticResource SecondaryText}"/>

                                </StackPanel>

                                <StackPanel Grid.Column="2" VerticalAlignment="Top">

                                    <Button Content="Редактировать"
                                            Tag="{Binding AdID}"
                                            Margin="0 0 0 8"
                                            Click="EditAd_Click"
                                            Visibility="{Binding IsOwner, Converter={StaticResource BoolToVis}}"/>

                                    <Button Content="Удалить"
                                            Style="{StaticResource DangerButton}"
                                            Padding="5"
                                            FontSize="12"
                                            Tag="{Binding AdID}"
                                            Click="DeleteAd_Click"
                                            Visibility="{Binding IsOwner, Converter={StaticResource BoolToVis}}"/>
                                </StackPanel>
                            </Grid>

                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

    </Grid>
</Page>
